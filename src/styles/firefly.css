/* Firefly Signal System — CSS tokens and animations */

@theme {
  /* Colors */
  --color-firefly-glow: oklch(0.85 0.15 85);
  --color-firefly-dim: oklch(0.6 0.05 85);
  --color-firefly-insight: oklch(0.88 0.2 92);

  /* Durations */
  --duration-slow: 8s;
  --duration-medium: 350ms;
  --duration-fast: 400ms;
  --duration-analyze: 700ms;
  --duration-insight: 520ms;

  /* Easings */
  --ease-smooth: cubic-bezier(0.25, 0.46, 0.45, 0.94);
  --ease-bounce: cubic-bezier(0.165, 0.84, 0.44, 1);
}

/* Keyframe animations */
@keyframes firefly-idle {

  0%,
  100% {
    opacity: 0.4;
    transform: scale(1) translateZ(0);
  }

  50% {
    opacity: 0.68;
    transform: scale(1.06) translateZ(0);
  }
}

@keyframes firefly-tracking {
  0% {
    transform: scale(1) translateZ(0);
    opacity: 0.6;
  }

  100% {
    transform: scale(1.12) translateZ(0);
    opacity: 0.85;
  }
}

@keyframes firefly-analyzing {

  0%,
  100% {
    transform: scale(1) translateZ(0);
    opacity: 0.7;
  }

  50% {
    transform: scale(1.18) translateZ(0);
    opacity: 0.95;
  }
}

@keyframes firefly-insight {

  0%,
  100% {
    transform: scale(1) translateZ(0);
    opacity: 0.7;
    box-shadow:
      0 0 10px 2px rgba(251, 191, 36, 0.35),
      0 0 20px 5px rgba(251, 191, 36, 0.2);
  }

  45% {
    transform: scale(1.28) translateZ(0);
    opacity: 1;
    box-shadow:
      0 0 14px 4px rgba(255, 235, 130, 0.75),
      0 0 28px 8px rgba(255, 210, 90, 0.45);
  }
}

/* Wing Animations */
@keyframes wing-idle-left {

  0%,
  100% {
    transform: rotate(-10deg) scaleX(0.9);
    opacity: 0.3;
  }

  50% {
    transform: rotate(-35deg) scaleX(1);
    opacity: 0.6;
  }
}

@keyframes wing-idle-right {

  0%,
  100% {
    transform: rotate(10deg) scaleX(0.9);
    opacity: 0.3;
  }

  50% {
    transform: rotate(35deg) scaleX(1);
    opacity: 0.6;
  }
}

@keyframes wing-track-left {
  to {
    transform: rotate(60deg) scaleX(0.6) translateY(4px);
    opacity: 0.2;
  }
}

@keyframes wing-track-right {
  to {
    transform: rotate(-60deg) scaleX(0.6) translateY(4px);
    opacity: 0.2;
  }
}

@keyframes wing-analyze-left {
  0% {
    transform: rotate(-15deg);
  }

  50% {
    transform: rotate(-45deg);
  }

  100% {
    transform: rotate(-15deg);
  }
}

@keyframes wing-analyze-right {
  0% {
    transform: rotate(15deg);
  }

  50% {
    transform: rotate(45deg);
  }

  100% {
    transform: rotate(15deg);
  }
}

@keyframes wing-insight-left {
  0% {
    transform: rotate(-10deg) scaleX(1);
    /* width implicit via scale */
  }

  50% {
    transform: rotate(-60deg) scaleX(1.6);
    /* width: 22px approx relative to 14px base is ~1.57x */
    opacity: 0.8;
    box-shadow: 0 0 8px gold;
  }

  100% {
    transform: rotate(-10deg) scaleX(1);
  }
}

@keyframes wing-insight-right {
  0% {
    transform: rotate(10deg) scaleX(1);
  }

  50% {
    transform: rotate(60deg) scaleX(1.6);
    opacity: 0.8;
    box-shadow: 0 0 8px gold;
  }

  100% {
    transform: rotate(10deg) scaleX(1);
  }
}


/* Utility classes */
.animate-firefly-idle {
  animation: firefly-idle var(--duration-slow) ease-in-out infinite;
}

.animate-firefly-tracking {
  animation: firefly-tracking var(--duration-medium) var(--ease-smooth) infinite alternate;
}

.animate-firefly-analyzing {
  animation: firefly-analyzing var(--duration-analyze) var(--ease-bounce) infinite;
}

.animate-firefly-insight {
  animation: firefly-insight var(--duration-insight) var(--ease-bounce) infinite;
}


/* Firefly component styles */
.firefly {
  position: absolute;
  pointer-events: none;
  width: 10px;
  height: 10px;
  display: grid;
  place-items: center;
  transform-origin: center;
  will-change: transform;
  contain: layout paint;
  z-index: 20;
}

.firefly-orb {
  position: relative;
  width: 100%;
  height: 100%;
  border-radius: 9999px;
  background-color: #fbbf24;
  box-shadow:
    0 0 8px 2px rgba(251, 191, 36, 0.5),
    0 0 16px 4px rgba(251, 191, 36, 0.3);
  transform-origin: center;
  will-change: transform, opacity;
  z-index: 2;
}

/* Wing Styles */
.firefly-wings {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 100%;
  height: 100%;
  transform: translate(-50%, -50%);
  pointer-events: none;
  z-index: 1;
  /* Below orb */
}

.firefly-wing {
  position: absolute;
  top: 40%;
  width: 13px;
  height: 8px;
  border-top: 1px solid rgba(251, 191, 36, 0.7);
  box-shadow: 0 -1px 4px rgba(251, 191, 36, 0.2);
  opacity: 0.6;
  will-change: transform;
  /* Make them look like thin threads */
  border-radius: 100% 0 0 0;
}

.firefly-wing.left {
  right: 50%;
  transform-origin: 100% 60%;
  /* Pivot near center-right */
  margin-right: -2px;
  transform: rotate(-20deg);
}

.firefly-wing.right {
  left: 50%;
  transform-origin: 0% 60%;
  /* Pivot near center-left */
  margin-left: -2px;
  transform: rotate(20deg) scaleX(-1);
  /* Mirror */
}


/* Wing State Animations */
[data-state='idle'] .firefly-wing.left {
  animation: wing-idle-left 5s ease-in-out infinite;
}

[data-state='idle'] .firefly-wing.right {
  animation: wing-idle-right 5s ease-in-out infinite;
}

[data-state='tracking'] .firefly-wing.left {
  animation: wing-track-left 0.3s ease-out forwards;
}

[data-state='tracking'] .firefly-wing.right {
  animation: wing-track-right 0.3s ease-out forwards;
}

[data-state='analyzing'] .firefly-wing.left {
  animation: wing-analyze-left 0.1s linear infinite;
}

[data-state='analyzing'] .firefly-wing.right {
  animation: wing-analyze-right 0.1s linear infinite;
}

[data-state='insight'] .firefly-wing.left {
  animation: wing-insight-left 0.6s ease-out infinite;
}

[data-state='insight'] .firefly-wing.right {
  animation: wing-insight-right 0.6s ease-out infinite;
}


/* Orb State Colors */
.firefly-idle,
.firefly-tracking {
  background-color: var(--color-firefly-glow);
}

.firefly-analyzing {
  background-color: #fcd34d;
}

.firefly-insight {
  background-color: var(--color-firefly-insight);
}

/* Reduced Motion Static States */
.firefly-idle-static,
.firefly-tracking-static,
.firefly-analyzing-static,
.firefly-insight-static {
  animation: none;
  opacity: 0.72;
  transform: scale(1) translateZ(0);
}

@media (prefers-reduced-motion: reduce) {

  .firefly-orb,
  .firefly-wing {
    animation: none;
    transform: none;
    transition: none;
  }

  [data-state='idle'] .firefly-wing.left,
  [data-state='idle'] .firefly-wing.right,
  [data-state='tracking'] .firefly-wing.left,
  [data-state='tracking'] .firefly-wing.right,
  [data-state='analyzing'] .firefly-wing.left,
  [data-state='analyzing'] .firefly-wing.right,
  [data-state='insight'] .firefly-wing.left,
  [data-state='insight'] .firefly-wing.right {
    animation: none;
    transform: none;
    transition: none;
  }

  .firefly-wing {
    display: none;
    /* Hide flashing wings in reduced motion */
  }
}


:root {
  --firefly-brand-text: #c05e0a;
  /* amber-700 saturated */
  --firefly-brand-shadow:
    0 0 6px rgba(251, 191, 36, 0.5),
    0 0 14px rgba(251, 191, 36, 0.2);
}

:root[data-theme="dark"] {
  --firefly-brand-text: #fef3c7;
  --firefly-brand-shadow:
    0 0 6px rgba(251, 191, 36, 1),
    /* tight inner glow */
    0 0 16px rgba(251, 191, 36, 0.7),
    /* mid amber halo */
    0 0 36px rgba(251, 191, 36, 0.35),
    /* outer warmth */
    0 0 60px rgba(245, 158, 11, 0.15);
  /* very wide ambient spill */
}

/* Typography for Logo */
.brand-firefly {
  font-family: 'Caveat', cursive;
  font-weight: 700;
  color: var(--firefly-brand-text);
  letter-spacing: 0.02em;
  /* Light-mode default: tighter, more saturated glow so it reads against pale backgrounds.
     FireflyHero writes --firefly-breath (0–1) each rAF frame. */
  text-shadow:
    0 0 calc(2px + var(--firefly-breath, 0.5) * 8px) rgba(180, 80, 0, calc(0.7 + var(--firefly-breath, 0.5) * 0.3)),
    0 0 calc(6px + var(--firefly-breath, 0.5) * 12px) rgba(245, 158, 11, calc(0.4 + var(--firefly-breath, 0.5) * 0.4));
}

/* Dark-mode: wider, softer glow — luminous against the dark background */
[data-theme="dark"] .brand-firefly {
  text-shadow:
    0 0 calc(4px + var(--firefly-breath, 0.5) * 14px) rgba(251, 191, 36, calc(0.55 + var(--firefly-breath, 0.5) * 0.45)),
    0 0 calc(10px + var(--firefly-breath, 0.5) * 20px) rgba(245, 158, 11, calc(0.2 + var(--firefly-breath, 0.5) * 0.3));
}

@media (prefers-reduced-motion: reduce) {
  .brand-firefly {
    /* Static mid-glow when animation is off */
    text-shadow: var(--firefly-brand-shadow);
  }
}